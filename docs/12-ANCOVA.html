<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mallory L. Barnes">

<title>12&nbsp; Analysis of Covariance (ANCOVA) – Answering questions with data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./13-Thinking.html" rel="next">
<link href="./11-MixedANOVA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="12&nbsp; Analysis of Covariance (ANCOVA) – Answering questions with data">
<meta property="og:description" content="">
<meta property="og:image" content="12-ANCOVA_files/figure-html/unnamed-chunk-3-1.png">
<meta property="og:site_name" content="Answering questions with data">
<meta name="twitter:title" content="12&nbsp; Analysis of Covariance (ANCOVA) – Answering questions with data">
<meta name="twitter:description" content="A free textbook teaching introductory statistics for environmental science graduate students, including a lab manual, and course website. Licensed on CC BY SA 4.0">
<meta name="twitter:image" content="imgs/TextbookCover.png">
<meta name="twitter:site" content="@mallory_barnes">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12-ANCOVA.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of Covariance (ANCOVA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Answering questions with data</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/malloryb/statistics_E538" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Science_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Statistics?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Describing_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Describing Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-SamplesPopulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability, Sampling, and Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Foundation_Inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Foundations for inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Hypothesis_Testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-ttests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">t-tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-RMANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Repeated Measures ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-FactorialANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Allow HTML inside a PDF build (prevents early abort).</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-MixedANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">More On Factorial Designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-ANCOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of Covariance (ANCOVA)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Thinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Thinking about answering questions with data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Gifs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">GIFs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#general-linear-models-glm" id="toc-general-linear-models-glm" class="nav-link active" data-scroll-target="#general-linear-models-glm"><span class="header-section-number">12.1</span> General Linear Models (GLM)</a>
  <ul class="collapse">
  <li><a href="#model-statements" id="toc-model-statements" class="nav-link" data-scroll-target="#model-statements"><span class="header-section-number">12.1.1</span> Model Statements:</a></li>
  <li><a href="#flexibility-and-applicability-of-glms" id="toc-flexibility-and-applicability-of-glms" class="nav-link" data-scroll-target="#flexibility-and-applicability-of-glms"><span class="header-section-number">12.1.2</span> Flexibility and Applicability of GLMs</a></li>
  <li><a href="#understanding-anova-as-a-linear-model" id="toc-understanding-anova-as-a-linear-model" class="nav-link" data-scroll-target="#understanding-anova-as-a-linear-model"><span class="header-section-number">12.1.3</span> Understanding ANOVA as a linear model:</a></li>
  </ul></li>
  <li><a href="#moving-beyond-regression-and-anova-to-ancova" id="toc-moving-beyond-regression-and-anova-to-ancova" class="nav-link" data-scroll-target="#moving-beyond-regression-and-anova-to-ancova"><span class="header-section-number">12.2</span> Moving Beyond Regression and ANOVA to ANCOVA</a>
  <ul class="collapse">
  <li><a href="#understanding-ancova" id="toc-understanding-ancova" class="nav-link" data-scroll-target="#understanding-ancova"><span class="header-section-number">12.2.1</span> Understanding ANCOVA</a></li>
  </ul></li>
  <li><a href="#introducing-the-indicator-or-dummy-variable" id="toc-introducing-the-indicator-or-dummy-variable" class="nav-link" data-scroll-target="#introducing-the-indicator-or-dummy-variable"><span class="header-section-number">12.3</span> Introducing the Indicator or Dummy Variable</a>
  <ul class="collapse">
  <li><a href="#understanding-indicator-variables" id="toc-understanding-indicator-variables" class="nav-link" data-scroll-target="#understanding-indicator-variables"><span class="header-section-number">12.3.1</span> Understanding Indicator Variables</a></li>
  <li><a href="#interaction-term-in-glms" id="toc-interaction-term-in-glms" class="nav-link" data-scroll-target="#interaction-term-in-glms"><span class="header-section-number">12.3.2</span> Interaction Term in GLMs</a></li>
  <li><a href="#terminology-in-glms" id="toc-terminology-in-glms" class="nav-link" data-scroll-target="#terminology-in-glms"><span class="header-section-number">12.3.3</span> Terminology in GLMs</a></li>
  </ul></li>
  <li><a href="#so-what-exactly-is-ancova" id="toc-so-what-exactly-is-ancova" class="nav-link" data-scroll-target="#so-what-exactly-is-ancova"><span class="header-section-number">12.4</span> So, What Exactly is ANCOVA?</a>
  <ul class="collapse">
  <li><a href="#the-null-hypothesis-in-ancova" id="toc-the-null-hypothesis-in-ancova" class="nav-link" data-scroll-target="#the-null-hypothesis-in-ancova"><span class="header-section-number">12.4.1</span> The Null Hypothesis in ANCOVA</a></li>
  <li><a href="#testing-the-null-hypothesis" id="toc-testing-the-null-hypothesis" class="nav-link" data-scroll-target="#testing-the-null-hypothesis"><span class="header-section-number">12.4.2</span> Testing the Null Hypothesis</a></li>
  </ul></li>
  <li><a href="#illustrating-ancova-with-an-example" id="toc-illustrating-ancova-with-an-example" class="nav-link" data-scroll-target="#illustrating-ancova-with-an-example"><span class="header-section-number">12.5</span> Illustrating ANCOVA with an Example</a>
  <ul class="collapse">
  <li><a href="#setting-the-stage" id="toc-setting-the-stage" class="nav-link" data-scroll-target="#setting-the-stage"><span class="header-section-number">12.5.1</span> Setting the Stage</a></li>
  <li><a href="#crafting-the-model" id="toc-crafting-the-model" class="nav-link" data-scroll-target="#crafting-the-model"><span class="header-section-number">12.5.2</span> Crafting the Model</a></li>
  <li><a href="#why-were-running-the-ancova" id="toc-why-were-running-the-ancova" class="nav-link" data-scroll-target="#why-were-running-the-ancova"><span class="header-section-number">12.5.3</span> Why We’re Running the ANCOVA</a></li>
  <li><a href="#null-and-alternative-hypotheses-in-our-example-ancova" id="toc-null-and-alternative-hypotheses-in-our-example-ancova" class="nav-link" data-scroll-target="#null-and-alternative-hypotheses-in-our-example-ancova"><span class="header-section-number">12.5.4</span> Null and Alternative Hypotheses in our example ANCOVA</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">12.5.5</span> Analysis</a></li>
  <li><a href="#results-of-the-ancova-model" id="toc-results-of-the-ancova-model" class="nav-link" data-scroll-target="#results-of-the-ancova-model"><span class="header-section-number">12.5.6</span> Results of the ANCOVA Model</a></li>
  <li><a href="#contextualizing-the-findings" id="toc-contextualizing-the-findings" class="nav-link" data-scroll-target="#contextualizing-the-findings"><span class="header-section-number">12.5.7</span> Contextualizing the Findings:</a></li>
  </ul></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">12.6</span> Chapter Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/malloryb/statistics_E538/edit/master/12-ANCOVA.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Analysis of Covariance (ANCOVA)</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mallory L. Barnes </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">December 4, 2023</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="general-linear-models-glm" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="general-linear-models-glm"><span class="header-section-number">12.1</span> General Linear Models (GLM)</h2>
<p>General Linear Models (GLMs) are a class of models that encompass various types of statistical analyses, including ANOVA, and regression. They’re flexible enough to handle different types of data and relationships:</p>
<p>In our journey through statistical modeling, we’ve encountered three primary parametric models, each suited for different types of data scenarios:</p>
<ul>
<li><strong>No Groups and No Relationships (H0):</strong>
<ul>
<li>This scenario often emerges when our ANOVA or regression analysis yields non-significant results.</li>
<li><strong>What We Report:</strong> The grand mean and overall variance or standard deviation. Alternatively, we can use a confidence interval to encapsulate this information.</li>
</ul></li>
<li><strong>Two or More Categories with Significantly Different Means (t-test, ANOVA):</strong>
<ul>
<li>Here, we delve into data where group means are distinct and significant.</li>
<li><strong>What We Report:</strong> Group means. In classical ANOVA, we might report a common variance or standard deviation, or opt for group-specific measures (potentially through confidence intervals), ensuring to note that variances are not significantly different. With Welch’s t-test, we focus on group-specific variance or standard deviation.</li>
</ul></li>
<li><strong>Two Continuous Variables with a Significant Linear or Monotonic Relationship (Regression):</strong>
<ul>
<li>This model applies when there’s a significant linear relationship between two continuous variables.</li>
<li><strong>What We Report:</strong> The equation of the regression line, along with its confidence limits. We can also select specific x-values and provide confidence intervals for the predicted y-values at those points.</li>
</ul></li>
</ul>
<section id="model-statements" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="model-statements"><span class="header-section-number">12.1.1</span> Model Statements:</h3>
<ul>
<li><strong>No Groups/Relationships:</strong> <span class="math inline">\(y \sim N(\mu, \sigma^2)\)</span></li>
<li><strong>Categories with Different Means:</strong> <span class="math inline">\(y_{i,j} = \mu + \tau_i + \epsilon\)</span> (t-test allows for unequal variance: <span class="math inline">\(y_{i,j} = \mu + \tau_i + \epsilon_i\)</span>)</li>
<li><strong>Linear Relationship:</strong> <span class="math inline">\(y = \beta_0 + \beta_1x + \epsilon\)</span></li>
</ul>
</section>
<section id="flexibility-and-applicability-of-glms" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="flexibility-and-applicability-of-glms"><span class="header-section-number">12.1.2</span> Flexibility and Applicability of GLMs</h3>
<p>Ms enable us to model more complex relationships beyond the basic categorical X with continuous Y (as in t-tests and ANOVA) or continuous X with continuous Y (as in regression). They can handle diverse data types and model relationships that aren’t strictly linear, making them crucial for studying environmental systems.</p>
<p>So far, in our exploration of parametric tests, we have primarily focused on two types of relationships:</p>
<ul>
<li><strong>A categorical X and a continuous Y:</strong> This includes tests like the t-test and ANOVA.</li>
<li><strong>A continuous X and a continuous Y:</strong> This is typically analyzed using linear regression.</li>
</ul>
<p>General Linear Models (GLMs) significantly expand our analytically capabilities. They are not limited to just these basic scenarios but offer a more versatile toolkit. GLMs are particularly adept at handling:</p>
<ul>
<li><strong>More Complex Relationships:</strong> They can model scenarios where relationships between variables are not strictly linear.</li>
<li><strong>Diverse Data Types:</strong> GLMs are suitable for various data types, including count data, which is often encountered in environmental studies.</li>
</ul>
</section>
<section id="understanding-anova-as-a-linear-model" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="understanding-anova-as-a-linear-model"><span class="header-section-number">12.1.3</span> Understanding ANOVA as a linear model:</h3>
<p>ANOVA, or Analysis of Variance, is traditionally viewed as a technique to compare means across multiple groups. However, at its core, ANOVA is a linear model. It’s a special case where the predictors are categorical, not continuous. This distinction is important but subtle. Let’s delve into an example that illustrates this concept clearly.</p>
<p>This example should be familiar from lecture. Imagine a researcher is exploring the effects of metal contamination on the species richness of sessile marine invertebrates. They’re particularly interested in the impact of copper and the orientation of the substrate on which these organisms live. To investigate this, they conduct a factorial experiment, measuring species richness across different levels of copper enrichment (None, Low, High) and substrate orientation (Vertical, Horizontal). This setup allows us to not only consider each factor separately but also examine their potential interaction.</p>
<p>The ANOVA framework provides three null hypotheses to test:</p>
<ol type="1">
<li><p>There are no differences in species richness across the copper levels.</p></li>
<li><p>There are no differences in species richness between substrate orientations.</p></li>
<li><p>There is no interaction effect between copper levels and substrate orientation.</p></li>
</ol>
<p>These hypotheses can be represented in a linear model as follows:</p>
<p><span class="math inline">\(y_{ijk} = \beta_0 + \beta_{Copper_i} + \beta_{Orientation_j} + \beta_{Copper \times Orientation_{ij}} + \varepsilon_{ijk}\)</span></p>
<p>Here, <span class="math inline">\(\beta_0\)</span> is the grand mean (intercept), <span class="math inline">\(\beta_{Copper_i}\)</span> and <span class="math inline">\(\beta_{Orientation_j}\)</span> are the main effects of the copper levels and orientation, respectively, and <span class="math inline">\(\beta_{Copper \times Orientation_{ij}}\)</span> represents the interaction between these factors. The <span class="math inline">\(\varepsilon_{ijk}\)</span> term captures the residual variance, or the random deviation of each observation from the model prediction. The significance of each beta coefficient is tested to determine if it makes a meaningful contribution to the model. A non-significant beta suggests that the corresponding factor or interaction does not have a distinct effect on the outcome, and therefore, might be omitted from the model for parsimony.</p>
<p>When conducting an ANOVA, we’re essentially fitting a linear model with categorical predictors. These predictors are represented by beta coefficients in our model, which show the unique contribution of each factor (like copper levels or substrate orientation) to the outcome variable (such as species richness). The critical question we ask is whether each beta coefficient is significant—does it make a meaningful difference to our model?</p>
<p>In statistical terms, we assess this by examining the F-statistic. The F-statistic is a ratio that compares the amount of variance explained by a particular factor to the variance not explained by the model (within-group variance or error). A higher F-statistic indicates that the factor explains a significant portion of the variability in the outcome variable, while a lower F-statistic suggests that the factor does not contribute much to our understanding of the outcome variable.</p>
<p><span class="math inline">\(F = \frac{MS_{Treatment}}{MS_{Error}}\)</span>.</p>
<p>In an ANOVA with two factors, we calculate the F-statistic for each factor and their interaction. We don’t need to show the actual calculation here—what matters is that the F-statistic tells us if the factor makes a significant contribution. If it does, we keep the beta coefficient in our model. If not, we may consider omitting it for a simpler model.</p>
<p>It turns out that ANOVAs are just a type of linear model in which the predictor variable is categorical. In practice, we can perform ANOVA using the <code>lm()</code> function in R, treating the categorical predictors as factors. This allows us to use the familiar beta notation and interpret ANOVA as a linear regression model with categorical predictors.</p>
</section>
</section>
<section id="moving-beyond-regression-and-anova-to-ancova" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="moving-beyond-regression-and-anova-to-ancova"><span class="header-section-number">12.2</span> Moving Beyond Regression and ANOVA to ANCOVA</h2>
<p>As we’ve explored statistical modeling, we’ve understood the power of both regression and ANOVA. Now, let’s merge these concepts to broaden our analytical horizon. ANCOVA, or Analysis of Covariance, allows us to examine relationships across different categories, enhancing our ability to compare and understand varying trends within our data.</p>
<p>Consider these questions that may arise in environmental research:</p>
<ul>
<li><p>Are dbh (Diameter at Breast Height) and height related similarly for tulip poplars and oaks?</p></li>
<li><p>Are biomass and BTUs (British Thermal Units) related similarly for corn stover and Miscanthus?</p></li>
<li><p>Does the exposure to PFAS correlate with the lifetime incidence of cancer uniformily across low- and high-income American populations?</p></li>
</ul>
<p>This specific subsection of general linear models is known as <strong>Analysis of Covariance – ANCOVA</strong>. Each of these questions challenges us to compare relationships across categories, which is precisely where ANCOVA shines.</p>
<hr>
<section id="understanding-ancova" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="understanding-ancova"><span class="header-section-number">12.2.1</span> Understanding ANCOVA</h3>
<p>With ANCOVA, if we identify a significant difference between two linear relationships, our model will represent two distinct lines. The challenge then becomes integrating these two lines into a single equation.</p>
<section id="conceptualizing-the-transformation" class="level4" data-number="12.2.1.1">
<h4 data-number="12.2.1.1" class="anchored" data-anchor-id="conceptualizing-the-transformation"><span class="header-section-number">12.2.1.1</span> Conceptualizing the Transformation</h4>
<p>Consider the following equations:</p>
<ul>
<li><code>y = 2x + 3</code></li>
<li><code>y = 3x - 4</code></li>
</ul>
<p>The question we pose is: What modifications are required to transform the first equation into the second? This involves determining the adjustments needed in terms of x (the slope) and the constant term. Understanding this transformation is key to grasping how ANCOVA allows us to compare different linear relationships within a single model framework.</p>
</section>
</section>
</section>
<section id="introducing-the-indicator-or-dummy-variable" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="introducing-the-indicator-or-dummy-variable"><span class="header-section-number">12.3</span> Introducing the Indicator or Dummy Variable</h2>
<p>In General Linear Models (GLMs), indicator or dummy variables allow us to include categorical variables in models traditionally designed for continuous variables.</p>
<section id="understanding-indicator-variables" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="understanding-indicator-variables"><span class="header-section-number">12.3.1</span> Understanding Indicator Variables</h3>
<p>Indicator variables are used to encode categories. For <code>n</code> categories, you need <code>n-1</code> indicator variables.</p>
<p>Consider a scenario with 5 species of wombat. We can code these species using 4 indicator variables:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Ind1</th>
<th>Ind2</th>
<th>Ind3</th>
<th>Ind4</th>
<th>Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Species 1</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Species 2</td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>Species 3</td>
</tr>
<tr class="even">
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>Species 4</td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Species 5</td>
</tr>
</tbody>
</table>
<p>In the simplest case of two categories, only one indicator variable is needed:</p>
<ul>
<li>0 = Wombat Species 1</li>
<li>1 = Wombat Species 2</li>
</ul>
<section id="flipping-the-switch-indicator-variables-in-action" class="level4" data-number="12.3.1.1">
<h4 data-number="12.3.1.1" class="anchored" data-anchor-id="flipping-the-switch-indicator-variables-in-action"><span class="header-section-number">12.3.1.1</span> Flipping the Switch: Indicator Variables in Action</h4>
<p>In the context of GLMs, “turning on” an indicator variable means assigning it a value of 1. This action activates certain terms in the equation that are multiplied by the indicator variable, thereby altering the model’s output.</p>
<p>When an indicator variable (<code>xc</code>) is set to 1, it effectively activates any terms in the equation that are multiplied by <code>xc</code>. This can change the slope and/or intercept of the regression line, depending on how <code>xc</code> is used in the equation.</p>
<p>For example, in the equation <code>y = 2xl + 3 + 1xcxl - 7xc</code>:</p>
<ul>
<li><p>When <code>xc</code> = 0 (turned off), the equation simplifies to <code>y = 2xl + 3</code>. Here, the terms <code>1xcxl</code> and <code>-7xc</code> are deactivated because they are multiplied by <code>xc</code>, which is 0.</p></li>
<li><p>When <code>xc</code> = 1 (turned on), the equation becomes <code>y = (2xl + 3) + (1xl - 7)</code>. In this case, the terms <code>1xcxl</code> and <code>-7xc</code> are activated, altering the slope and intercept of the line.</p></li>
</ul>
</section>
<section id="visualizing-the-effect" class="level4" data-number="12.3.1.2">
<h4 data-number="12.3.1.2" class="anchored" data-anchor-id="visualizing-the-effect"><span class="header-section-number">12.3.1.2</span> Visualizing the Effect</h4>
<p>The R plots below demonstrate the change in the regression line when the indicator variable is toggled between being active (<code>xc = 1</code>) and inactive (<code>xc = 0</code>).</p>
<p><strong>When <code>xc</code> = 0:</strong></p>
<p><em>Equation Simplified:</em> <code>y = 2xl + 3</code></p>
<p><strong>When <code>xc</code> = 1:</strong></p>
<p><em>Equation Modified:</em> <code>y = (2xl + 3) + (1xl - 7)</code></p>
<p>The plot on the left shows the regression line when the indicator variable is inactive. The equation simplifies, reflecting a scenario where the categorical variable does not influence the outcome.</p>
<p>The plot on the right illustrates the regression line when the indicator variable is active. The equation now includes additional terms, showcasing how the presence of the categorical variable changes the relationship between <code>xl</code> and <code>y</code>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12-ANCOVA_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>Using indicator variables, we can create models in which regression lines change completely depending on which category we’re modeling. If we need to tweak both the intercept and the slope, then we will need two new regression parameters – <span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span>.</p>
</section>
</section>
<section id="interaction-term-in-glms" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="interaction-term-in-glms"><span class="header-section-number">12.3.2</span> Interaction Term in GLMs</h3>
<p>Just like in ANOVA, interaction terms in GLMs tell us whether one variable’s effect on the outcome changes when another variable comes into play.</p>
<ul>
<li><strong>Simple Definition:</strong> In statistics, an interaction term helps us understand if the effect of one factor (like temperature) on an outcome (like plant growth) changes when another factor (like rainfall) is also considered. It’s like asking, “Does the relationship between temperature and plant growth change when we also consider how much it rains?”</li>
</ul>
<section id="the-math-behind-the-interactions" class="level4" data-number="12.3.2.1">
<h4 data-number="12.3.2.1" class="anchored" data-anchor-id="the-math-behind-the-interactions"><span class="header-section-number">12.3.2.1</span> The Math Behind The Interactions</h4>
<ul>
<li><strong>Model Equation Explained:</strong></li>
</ul>
<p>Let’s break down a typical equation:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1x_l + \beta_2x_c + \beta_3x_lx_c + \epsilon
\]</span></p>
<p>Here, <span class="math inline">\(x_lx_c\)</span> is the interaction term, and <span class="math inline">\(\beta _3\)</span> is its coefficient.</p>
<ul>
<li><span class="math inline">\(y\)</span> is what we’re trying to predict (like plant growth).</li>
<li><span class="math inline">\(\beta_0\)</span> is the starting point of our prediction when all other factors are zero.</li>
<li><span class="math inline">\(\beta_1x_l\)</span> shows how our prediction changes with changes in a continuous variable (like temperature).</li>
<li><span class="math inline">\(\beta_2x_c\)</span> shows the change with a categorical variable (like type of plant).</li>
<li><span class="math inline">\(\beta_3x_lx_c\)</span> is the key player here. It shows how the effect of our continuous variable (temperature) changes across different categories (types of plants).</li>
<li><span class="math inline">\(\epsilon\)</span> is the error term, accounting for variations we can’t explain with our model.</li>
<li><span class="math inline">\(\beta_1x_l\)</span> and <span class="math inline">\(\beta_2x_c\)</span> represent the main effects of the continuous and categorical variables, respectively.</li>
</ul>
</section>
<section id="when-is-the-interaction-term-significant" class="level4" data-number="12.3.2.2">
<h4 data-number="12.3.2.2" class="anchored" data-anchor-id="when-is-the-interaction-term-significant"><span class="header-section-number">12.3.2.2</span> When is the Interaction Term Significant?</h4>
<ul>
<li><strong>Significance of</strong> <span class="math inline">\(\beta_3x_lx_c\)</span> :</li>
</ul>
<p>If <span class="math inline">\(\beta_3x_lx_c\)</span> (our interaction term) is significant, it means the relationship between our continuous variable (like temperature) and our outcome (plant growth) is different for different categories (like types of plants). If <span class="math inline">\(\beta_3x_lx_c\)</span> is not significant, it suggests that the effect of our continuous variable is consistent across categories, and we might not need this term in our model.</p>
</section>
<section id="what-are-the-options-for-our-model" class="level4" data-number="12.3.2.3">
<h4 data-number="12.3.2.3" class="anchored" data-anchor-id="what-are-the-options-for-our-model"><span class="header-section-number">12.3.2.3</span> What are the options for our model?</h4>
<ol type="1">
<li><strong>Full Model with Interaction (</strong><span class="math inline">\(\beta_0, \beta_1, \beta_2, \beta_3\)</span>):
<ul>
<li>When both the categorical (<span class="math inline">\(x_c\)</span>) and continuous (<span class="math inline">\(x_l\)</span>) variables are significant, and there is a significant interaction (<span class="math inline">\(\beta_3\)</span>), the model unfolds into two distinct linear equations for each category of<span class="math inline">\(x_c\)</span>. This indicates that the relationship between the continuous variable and the outcome differs depending on the category of the categorical variable.</li>
<li>Equations:
<ul>
<li>For <span class="math inline">\(x_c = 0\)</span>: <span class="math inline">\(y = \beta_0 + \beta_1x_l\)</span></li>
<li>For <span class="math inline">\(x_c = 1\)</span>: <span class="math inline">\(y = (\beta_0 + \beta_2) + (\beta_1 + \beta_3)x_l\)</span></li>
</ul></li>
</ul></li>
<li>**Model without Interaction ((_0, _1, _2)):**
<ul>
<li>If both the categorical and continuous variables are significant, but there is no interaction, the model simplifies to parallel lines for each category of $x_c $,, indicating that the slope (effect of <span class="math inline">\(x_l\)</span>, is consistent across categories.</li>
<li>Equations:
<ul>
<li>For <span class="math inline">\(x_c = 0\)</span>: <span class="math inline">\(y = \beta_0 + \beta_1x_l\)</span></li>
<li>For <span class="math inline">\(x_c = 1\)</span>: <span class="math inline">\(y = (\beta_0 + \beta_2) + \beta_1x_l\)</span></li>
</ul></li>
</ul></li>
<li><strong>Simple Linear Regression (</strong><span class="math inline">\(\beta_0, \beta_1\)</span>):
<ul>
<li>If only the continuous variable (<span class="math inline">\(x_l\)</span>) is significant, the model reduces to a simple linear regression, indicating a linear relationship between<span class="math inline">\(x_l\)</span> and <span class="math inline">\(y\)</span>, regardless of the category of<span class="math inline">\(x_c\)</span>.</li>
<li>Equation: <span class="math inline">\(y = \beta_0 + \beta_1x_l\)</span></li>
</ul></li>
<li><strong>Two Different Means (T-test Equivalent) (</strong><span class="math inline">\(\beta_0, \beta_2\)</span>):
<ul>
<li>If the continuous variable is not significant but the categorical variable is, the model effectively becomes a comparison of means between two groups (similar to a t-test).</li>
<li>Equations:
<ul>
<li>For <span class="math inline">\(x_c = 0\)</span>: <span class="math inline">\(y = \beta_0\)</span></li>
<li>For <span class="math inline">\(x_c = 1\)</span>: <span class="math inline">\(y = \beta_0 + \beta_2\)</span></li>
</ul></li>
</ul></li>
<li><strong>Single Mean (One Sample Data) (</strong><span class="math inline">\(\beta_0\)</span>):
<ul>
<li>If neither variable is significant, the model reduces to a single mean, indicating no effect of either the continuous or categorical variable.</li>
<li>Equation: <span class="math inline">\(y = \beta_0\)</span></li>
</ul></li>
</ol>
</section>
</section>
<section id="terminology-in-glms" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="terminology-in-glms"><span class="header-section-number">12.3.3</span> Terminology in GLMs</h3>
<p>Understanding the terminology used in General Linear Models (GLMs) is important for grasping the concepts and effectively communicating your findings. Here are some key terms:</p>
<ul>
<li><p><strong>Fixed Factor:</strong> This refers to a categorical variable with specific, predefined categories. For example, if you’re studying the effect of different seasons (spring, summer, autumn, winter) on plant growth, ‘season’ is a fixed factor because it represents specific, distinct categories of interest.</p></li>
<li><p><strong>Random Factor:</strong> This is a categorical variable where the categories represent a random sample from a larger population. For instance, if you’re examining the output quality from different machines in a factory, and these machines are randomly selected from a larger set, then ‘machine’ is a random factor.</p></li>
<li><p><strong>Covariate:</strong> This is your continuous variable that varies along with the dependent variable (Y). In environmental studies, this could be something like temperature, rainfall, or pollution levels, which you suspect might influence your outcome of interest (like species distribution or plant growth).</p></li>
</ul>
<hr>
</section>
</section>
<section id="so-what-exactly-is-ancova" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="so-what-exactly-is-ancova"><span class="header-section-number">12.4</span> So, What Exactly is ANCOVA?</h2>
<p>Analysis of Covariance (ANCOVA) is a statistical method that combines the principles of ANOVA and regression. It’s designed to compare categorical independent variables—such as different treatments or groups—while controlling for the influence of continuous variables. These continuous variables, known as covariates, are typically not the primary focus but could affect the outcome.</p>
<p>For ANCOVA, you need:</p>
<ol type="1">
<li>A continuous dependent variable (the main effect you’re studying)</li>
<li>At least one continuous independent variable (covariate)</li>
<li>At least one categorical independent variable (which can be either a fixed or random factor)</li>
</ol>
<section id="the-null-hypothesis-in-ancova" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="the-null-hypothesis-in-ancova"><span class="header-section-number">12.4.1</span> The Null Hypothesis in ANCOVA</h3>
<p><strong>Demystifying the Concept</strong>: The null hypothesis in ANCOVA suggests that once we adjust for the covariates, the categorical independent variables do not significantly affect the dependent variable. Essentially, we’re testing whether the apparent differences between groups are genuine or just statistical noise.</p>
<p><strong>Mathematically Speaking</strong>: In a simple ANCOVA model, the null hypothesis posits that the adjusted means for each level of the categorical variable are equivalent, once we account for the covariate:</p>
<p><span class="math inline">\(H_0: \mu_1 = \mu_2 = \ldots = \mu_t\)</span></p>
<p><span class="math inline">\(H_A: \mu_i \neq \mu_j^* \text{ for some } i \neq j\)</span></p>
<p>This translates to: “After controlling for the covariate, the different levels of the categorical independent variable do not lead to different outcomes.”</p>
</section>
<section id="testing-the-null-hypothesis" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="testing-the-null-hypothesis"><span class="header-section-number">12.4.2</span> Testing the Null Hypothesis</h3>
<p><strong>Conducting the Test</strong>: When we perform ANCOVA, we examine the null hypothesis through an omnibus F-test. If we find sufficient evidence to reject the null hypothesis, we infer that significant differences exist among the adjusted means of the dependent variable across the categorical groups, even after considering the covariate.</p>
<p><strong>Interpreting the Findings</strong>: Rejecting the null hypothesis indicates that the categorical independent variable has a significant impact on the dependent variable, aside from the covariate’s effect. It’s crucial to remember, though, that statistical significance doesn’t automatically translate to practical significance. We must always consider the results within the specific context and aims of the study.</p>
</section>
</section>
<section id="illustrating-ancova-with-an-example" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="illustrating-ancova-with-an-example"><span class="header-section-number">12.5</span> Illustrating ANCOVA with an Example</h2>
<section id="setting-the-stage" class="level3" data-number="12.5.1">
<h3 data-number="12.5.1" class="anchored" data-anchor-id="setting-the-stage"><span class="header-section-number">12.5.1</span> Setting the Stage</h3>
<p>Imagine we’re environmental scientists studying the impact of air pollution—a continuous variable—on bird species distribution, our dependent variable. We want to see if this relationship differs between urban and rural areas—our categorical variable. For this purpose, we’ve created a synthetic dataset to model the scenario.</p>
</section>
<section id="crafting-the-model" class="level3" data-number="12.5.2">
<h3 data-number="12.5.2" class="anchored" data-anchor-id="crafting-the-model"><span class="header-section-number">12.5.2</span> Crafting the Model</h3>
<p>With our data in hand, we’d construct an ANCOVA model to discern whether location type influences bird distribution, beyond what can be explained by pollution levels alone. This would involve coding our categorical variable (urban vs.&nbsp;rural) into a dummy variable and including air pollution as a covariate in the model. I’ve done this for you already by creating the synthetic dataset.</p>
<ul>
<li><strong>Dataset Overview:</strong> Our dataset comprises 200 observations, capturing bird species density in various urban and rural locations, along with corresponding levels of air pollution.</li>
</ul>
</section>
<section id="why-were-running-the-ancova" class="level3" data-number="12.5.3">
<h3 data-number="12.5.3" class="anchored" data-anchor-id="why-were-running-the-ancova"><span class="header-section-number">12.5.3</span> Why We’re Running the ANCOVA</h3>
<ul>
<li><p><strong>Research Question:</strong> Does the effect of air pollution on bird species density differ between urban and rural areas?</p></li>
<li><p><strong>Expectation:</strong> We predict that air pollution will have a more pronounced negative effect on bird species density in urban areas than in rural areas.</p></li>
</ul>
</section>
<section id="null-and-alternative-hypotheses-in-our-example-ancova" class="level3" data-number="12.5.4">
<h3 data-number="12.5.4" class="anchored" data-anchor-id="null-and-alternative-hypotheses-in-our-example-ancova"><span class="header-section-number">12.5.4</span> Null and Alternative Hypotheses in our example ANCOVA</h3>
<ol type="1">
<li><strong>Omnibus Null Hypothesis</strong> (<span class="math inline">\(H_0\)</span>): The null hypothesis posits that once we adjust for air pollution, the mean bird species density does not differ between urban and rural areas.</li>
</ol>
<p><span class="math inline">\(H_0: \mu^*_{\text{Urban}} = \mu^*_{\text{Rural}}\)</span></p>
<p><span class="math inline">\(H_A: \mu^*_{\text{Urban}} \neq \mu^*_{\text{Rural}}\)</span></p>
<p>Where <span class="math inline">\(\mu^*_{\text{Urban}}\)</span> and <span class="math inline">\(\mu^*_{\text{Rural}}\)</span> represent the adjusted means of bird species density for urban and rural areas, respectively..</p>
<ol start="2" type="1">
<li><p><strong>Null Hypothesis for Slope</strong> (<span class="math inline">\(H_{01}\)</span>): This hypothesis examines if the effect of air pollution on bird species density is consistent between urban and rural areas.</p>
<ul>
<li><span class="math inline">\(H_{01}\)</span>: There is no interaction between air pollution and area type; the slopes are parallel.</li>
<li><span class="math inline">\(H_{A1}\)</span>: There is an interaction; the effect of air pollution on bird species density differs between urban and rural areas.</li>
</ul></li>
</ol>
<p><span class="math inline">\(H_{01}: \beta_{\text{interaction}} = 0\)</span></p>
<p><span class="math inline">\(H_{A1}: \beta_{\text{interaction}} \neq 0\)</span></p>
<ol start="3" type="1">
<li><p><strong>Null Hypothesis for Intercept</strong> (<span class="math inline">\(H_{02}\)</span>): If we find no significant interaction, we then consider the intercepts. This hypothesis tests whether the baseline bird species density, at zero air pollution, differs between urban and rural areas.</p>
<ul>
<li><p><span class="math inline">\(H_{02}\)</span>: The intercepts are the same, indicating no difference in bird species density between urban and rural areas at zero air pollution.</p></li>
<li><p><span class="math inline">\(H_{A2}\)</span>: The intercepts differ, suggesting an inherent difference in bird species density between urban and rural areas, independent of air pollution.</p></li>
</ul></li>
</ol>
<p><span class="math inline">\(H_{02}: \beta_{0\text{,Urban}} = \beta_{0\text{,Rural}}\)</span></p>
<p><span class="math inline">\(H_{A2}: \beta_{0\text{,Urban}} \neq \beta_{0\text{,Rural}}\)</span></p>
<p>Rejecting <span class="math inline">\(H_{02}\)</span> would imply that there is an inherent difference in bird species density due to area type, even before considering the air pollution levels.</p>
<p>These hypotheses guide our ANCOVA model and analysis, aiming to isolate the effects of urbanization from the influence of air pollution on avian populations.</p>
</section>
<section id="analysis" class="level3" data-number="12.5.5">
<h3 data-number="12.5.5" class="anchored" data-anchor-id="analysis"><span class="header-section-number">12.5.5</span> Analysis</h3>
<section id="explore-the-data" class="level4" data-number="12.5.5.1">
<h4 data-number="12.5.5.1" class="anchored" data-anchor-id="explore-the-data"><span class="header-section-number">12.5.5.1</span> Explore the data</h4>
<div class="cell">
<pre><code>#&gt;   AreaType AirPollution BirdDensity
#&gt; 1    Urban        148.9          25
#&gt; 2    Urban         39.7          39
#&gt; 3    Urban         37.6          24
#&gt; 4    Rural         58.8          30
#&gt; 5    Urban         54.9          18
#&gt; 6    Rural         38.2          35</code></pre>
</div>
<p>Let’s create a summary of our current dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    AreaType          AirPollution     BirdDensity   </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Length:200         Min.   : 25.80   Min.   : 6.00  </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Class :character   1st Qu.: 54.45   1st Qu.:18.00  </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mode  :character   Median : 83.60   Median :25.00  </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Mean   : 86.14   Mean   :24.83  </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     3rd Qu.:117.72   3rd Qu.:32.00  </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Max.   :149.90   Max.   :43.00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will give us a quick statistical summary of our variables.</p>
<p>Now, let’s visualize the distribution of bird density in different areas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot for bird density by area type</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(BirdDensity <span class="sc">~</span> AreaType, <span class="at">data =</span> data, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Bird Density by Area Type"</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Area Type"</span>, <span class="at">ylab =</span> <span class="st">"Bird Density"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"aquamarine"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12-ANCOVA_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>And the same for air pollution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(AirPollution <span class="sc">~</span>area_type, <span class="at">data=</span>data, <span class="at">main=</span><span class="st">"Air Pollution by Area"</span>, <span class="at">xlab=</span><span class="st">"Area Type"</span>, <span class="at">ylab=</span> <span class="st">"Air Pollution"</span>, <span class="at">col=</span><span class="st">"aquamarine"</span>, <span class="at">border=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12-ANCOVA_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="results-of-the-ancova-model" class="level3" data-number="12.5.6">
<h3 data-number="12.5.6" class="anchored" data-anchor-id="results-of-the-ancova-model"><span class="header-section-number">12.5.6</span> Results of the ANCOVA Model</h3>
<p>The anova results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ancova <span class="ot">&lt;-</span> <span class="fu">aov</span>(BirdDensity <span class="sc">~</span> AirPollution<span class="sc">*</span>AreaType, <span class="at">data=</span>data)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                        Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AirPollution            1      6     5.9   0.086  0.7690    </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AreaType                1   1688  1688.0  24.788 1.4e-06 ***</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AirPollution:AreaType   1    291   291.3   4.277  0.0399 *  </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals             196  13347    68.1                    </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The linear model results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ancova_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(BirdDensity <span class="sc">~</span> AirPollution<span class="sc">*</span>AreaType, <span class="at">data=</span>data)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova_lm)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = BirdDensity ~ AirPollution * AreaType, data = data)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -17.9260  -6.2694   0.4038   5.9023  19.2857 </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)                 31.54648    2.28553  13.803  &lt; 2e-16 ***</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AirPollution                -0.04333    0.02476  -1.750 0.081641 .  </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AreaTypeUrban              -11.57676    3.02164  -3.831 0.000172 ***</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AirPollution:AreaTypeUrban   0.06695    0.03237   2.068 0.039943 *  </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 8.252 on 196 degrees of freedom</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1295, Adjusted R-squared:  0.1162 </span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 9.717 on 3 and 196 DF,  p-value: 5.23e-06</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="main-effects" class="level4" data-number="12.5.6.1">
<h4 data-number="12.5.6.1" class="anchored" data-anchor-id="main-effects"><span class="header-section-number">12.5.6.1</span> Main Effects:</h4>
<ul>
<li><p><strong>Air Pollution</strong>: The ANCOVA model does not find a significant main effect of air pollution on bird density (p = 0.7690 from ANOVA), indicating no consistent impact across the areas. However, the linear model’s marginal p-value (p = 0.081641) suggests a trend that might have been significant with a larger sample size or reduced variability.</p></li>
<li><p><strong>Area Type</strong>: There is a significant main effect of AreaType on bird density (p &lt; 0.001), indicating that there are considerable differences in bird density between rural and urban areas, with urban areas showing lower bird density.</p></li>
</ul>
</section>
<section id="interpreting-the-beta-coefficients" class="level4" data-number="12.5.6.2">
<h4 data-number="12.5.6.2" class="anchored" data-anchor-id="interpreting-the-beta-coefficients"><span class="header-section-number">12.5.6.2</span> Interpreting the Beta Coefficients:</h4>
<ul>
<li><p><strong>Intercept</strong>: Reflecting the expected bird density in rural areas at zero air pollution, the intercept is quite high, indicating a relatively healthy bird population in the absence of pollution.</p></li>
<li><p><strong>Area Type</strong>: The beta coefficient for our area type factor is significantly different from zero (p &lt; 0.001), suggesting a distinct difference in bird density between urban and rural areas. However, this effect is captured more precisely in the interaction term.</p></li>
<li><p><strong>Interaction Term</strong>: The significant beta for the interaction term confirms our hypothesis that air pollution’s effect on bird density is not uniform across urban and rural areas.</p></li>
</ul>
</section>
<section id="visual-representation" class="level4" data-number="12.5.6.3">
<h4 data-number="12.5.6.3" class="anchored" data-anchor-id="visual-representation"><span class="header-section-number">12.5.6.3</span> Visual Representation:</h4>
<p>The scatter plot with regression lines will demonstrate these relationships visually, showing the differing trends for urban and rural areas suggested by the significant interaction term.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="12-ANCOVA_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level4" data-number="12.5.6.4">
<h4 data-number="12.5.6.4" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">12.5.6.4</span> Interpretation:</h4>
<p>The significant interaction term indicates that the simple main effect of air pollution is not adequate to describe its impact on bird density. In urban areas, there seems to be a slightly positive or less negative relationship compared to rural areas, which could reflect a range of urban-specific factors affecting bird populations differently than in rural areas.</p>
</section>
</section>
<section id="contextualizing-the-findings" class="level3" data-number="12.5.7">
<h3 data-number="12.5.7" class="anchored" data-anchor-id="contextualizing-the-findings"><span class="header-section-number">12.5.7</span> Contextualizing the Findings:</h3>
<p>The lack of a significant main effect for air pollution in the presence of a significant interaction suggests complex underlying ecological dynamics. These findings call for nuanced environmental management strategies that address the specific challenges and conditions of urban and rural habitats to support bird conservation effectively. By considering the interaction term’s significance, we gain a more accurate understanding of the ecological effects of air pollution, which is essential for developing targeted conservation policies.</p>
</section>
</section>
<section id="chapter-summary" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="chapter-summary"><span class="header-section-number">12.6</span> Chapter Summary</h2>
<p>In this chapter, we explored the fundamental principles and applications of Analysis of Covariance (ANCOVA), a powerful statistical tool that extends beyond the capabilities of ANOVA by incorporating covariates. We began by understanding the conceptual framework of ANOVA as a linear model, setting the stage for the more complex ANCOVA analysis. Through our discussions, we emphasized the importance of the null and alternative hypotheses in ANCOVA, using practical examples like the study of bird species density in different environments to illustrate these concepts. The chapter highlighted how ANCOVA adjusts for the effects of additional variables, allowing us to more accurately isolate and understand the impact of our factors of interest. By integrating real-world scenarios and focusing on clear, practical applications, we aimed to demystify the process of hypothesis testing in ANCOVA, making it accessible and relevant to environmental science.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-mallory_barnes" class="csl-entry" role="listitem">
Barnes, Mallory L. 2023. <em>Statistics for Environmental Science</em>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./11-MixedANOVA.html" class="pagination-link" aria-label="More On Factorial Designs">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">More On Factorial Designs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./13-Thinking.html" class="pagination-link" aria-label="Thinking about answering questions with data">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Thinking about answering questions with data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/malloryb/statistics_E538/edit/master/12-ANCOVA.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>